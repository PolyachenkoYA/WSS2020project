(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     64236,       1472]
NotebookOptionsPosition[     63580,       1452]
NotebookOutlinePosition[     64050,       1470]
CellTagsIndexPosition[     64007,       1467]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Quiet", "[", 
    RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"checkFilePresentQ", "[", 
     RowBox[{"filepath_", ",", " ", 
      RowBox[{"verbose_", ":", "False"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"found", " ", "=", " ", 
        RowBox[{"FileExistsQ", "[", "filepath", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"verbose", ",", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<searching for '\>\"", ",", " ", "filepath", ",", " ", 
           "\"\<' ... \>\"", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", "found"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<NOT\>\"", ",", "Red"}], "]"}], ",", "\"\<\>\""}], 
            "]"}], ",", " ", "\"\< found\>\""}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "found"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getFilenameSafe", "[", 
     RowBox[{"path_", ",", " ", "ptrn_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"names", " ", "=", " ", 
        RowBox[{"FileNames", "[", 
         RowBox[{"ptrn", ",", "path"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "names", "]"}], ">", "0"}], ",", 
        RowBox[{"names", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"path", ",", " ", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"RandomChoice", "[", 
             RowBox[{
              RowBox[{"Alphabet", "[", "]"}], ",", "50"}], "]"}], "]"}]}], 
          "}"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getLinkFilename", "[", 
     RowBox[{"path_", ",", " ", "link_"}], "]"}], " ", ":=", " ", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"path", ",", " ", 
       RowBox[{"FileBaseName", "[", 
        RowBox[{"FileNameTake", "[", "link", "]"}], "]"}]}], "}"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"loadNew", "[", 
     RowBox[{"path_", ",", " ", "link_", ",", " ", 
      RowBox[{"verbose_", ":", "False"}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"archiveFile", ",", "unpackedFiles"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"verbose", ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<loading from '\>\"", ",", " ", "link", ",", "\"\<'\>\""}], 
           "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"archiveFile", " ", "=", " ", 
        RowBox[{"URLDownload", "[", 
         RowBox[{"link", ",", " ", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"path", ",", " ", 
             RowBox[{"FileNameTake", "[", "link", "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"CreateIntermediateDirectories", "\[Rule]", "True"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"verbose", ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"archiveFile", ",", " ", "\"\< loaded\>\""}], "]"}], 
          ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"unpackedFiles", " ", "=", " ", 
        RowBox[{"ExtractArchive", "[", 
         RowBox[{"archiveFile", ",", "path", ",", 
          RowBox[{"OverwriteTarget", "\[Rule]", "True"}], ",", 
          RowBox[{"CreateIntermediateDirectories", "\[Rule]", "True"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"verbose", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<unpacked: '\>\"", ",", " ", "unpackedFiles", ",", 
           "\"\<'\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"DeleteFile", "[", "archiveFile", "]"}], ";", 
       "\[IndentingNewLine]", "unpackedFiles"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"loadIfAbsent", "[", 
     RowBox[{"path_", ",", " ", "link_", ",", " ", 
      RowBox[{"verbose_", ":", "False"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "filepath", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"filepath", " ", "=", " ", 
        RowBox[{"getLinkFilename", "[", 
         RowBox[{"path", ",", " ", "link"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"checkFilePresentQ", "[", 
           RowBox[{"filepath", ",", " ", "verbose"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"loadNew", "[", 
           RowBox[{
            RowBox[{"DirectoryName", "[", "filepath", "]"}], ",", " ", "link",
             ",", " ", "verbose"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "filepath"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fileIsExecutableQ", "[", "cmd_", "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Quiet", "[", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"RunProcess", "[", 
         RowBox[{"cmd", ",", "\"\<ExitCode\>\""}], "]"}], ",", 
        "\"\<err\>\""}], "]"}], "]"}], "\[NotEqual]", "\"\<err\>\""}], 
    ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fileIsTheRightExecutableQ", "[", 
     RowBox[{"cmd_", ",", " ", 
      RowBox[{"testStr_", ":", "\"\<\>\""}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"localErrorFlag", "=", "\"\<err\>\""}], ",", "stdStr", ",", 
        "errStr"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"fileIsExecutableQ", "[", "cmd", "]"}], ",", 
        "\[IndentingNewLine]", "False", ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"StringStartsQ", "[", 
           RowBox[{
            RowBox[{"RunProcess", "[", 
             RowBox[{"cmd", ",", "\"\<StandardError\>\""}], "]"}], ",", " ", 
            "testStr"}], "]"}], ",", "\[IndentingNewLine]", "True", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StringStartsQ", "[", 
           RowBox[{
            RowBox[{"RunProcess", "[", 
             RowBox[{"cmd", ",", "\"\<StandardOutput\>\""}], "]"}], ",", " ", 
            "testStr"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InstallMyPckg", "[", 
     RowBox[{"OptionsPattern", "[", "]"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "reducePath", ",", "reduceExePath", ",", "reduceDatabasePath", ",", 
        " ", "reduceExeLink", ",", " ", "reduceDatabaseLink", ",", 
        "\[IndentingNewLine]", "msmsPath", ",", "msmsExePath", ",", 
        "pdb2xyzrExePath", ",", "pdb2xyzrDatabasePath", ",", "unpackedArch", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"rootPath", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "\"\<rootPath\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"doMSMS", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "\"\<doMSMS\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"doReduce", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "\"\<doReduce\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"verbose", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "\"\<verbose\>\"", "]"}]}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<forceReinstall\>\"", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"DeleteDirectory", "[", 
           RowBox[{"rootPath", ",", 
            RowBox[{"DeleteContents", "\[Rule]", "True"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"InstallMyPckg", "[", 
            RowBox[{"\"\<forceReinstall\>\"", "\[Rule]", "False"}], "]"}], 
           "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"DirectoryQ", "[", "rootPath", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"CreateDirectory", "[", 
          RowBox[{"rootPath", ",", 
           RowBox[{"CreateIntermediateDirectories", "\[Rule]", "True"}]}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"doMSMS", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"msmsPath", " ", "=", " ", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{"rootPath", ",", " ", "\"\<MSMS\>\""}], "}"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"msmsExePath", " ", "=", " ", 
           RowBox[{"getFilenameSafe", "[", 
            RowBox[{"msmsPath", ",", " ", 
             RowBox[{"$OperatingSystem", "/.", "msmsExeMask"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"pdb2xyzrExePath", " ", "=", " ", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{"msmsPath", ",", " ", "\"\<pdb_to_xyzr\>\""}], "}"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pdb2xyzrDatabasePath", " ", "=", " ", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{"msmsPath", ",", " ", "\"\<atmtypenumbers\>\""}], "}"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"checkFilePresentQ", "[", 
                RowBox[{"msmsExePath", ",", " ", "verbose"}], "]"}], "&&", 
               "\[IndentingNewLine]", 
               RowBox[{"checkFilePresentQ", "[", 
                RowBox[{"pdb2xyzrExePath", ",", " ", "verbose"}], "]"}], "&&",
                "\[IndentingNewLine]", 
               RowBox[{"checkFilePresentQ", "[", 
                RowBox[{"pdb2xyzrDatabasePath", ",", " ", "verbose"}], 
                "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"loadNew", "[", 
              RowBox[{"msmsPath", ",", " ", "\[IndentingNewLine]", 
               RowBox[{"$OperatingSystem", "/.", "msmsArchiveLinks"}], ",", 
               "verbose"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"msmsExePath", " ", "=", " ", 
           RowBox[{"getFilenameSafe", "[", 
            RowBox[{"msmsPath", ",", " ", "\"\<msms.x86_64Linux*\>\""}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"$OperatingSystem", "\[NotEqual]", "\"\<Windows\>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"fileIsExecutableQ", "[", "msmsExePath", "]"}]}], ",",
                "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"RunProcess", "[", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<chmod\>\"", ",", " ", "\"\<u+x\>\"", ",", " ", 
                   "msmsExePath"}], "}"}], "]"}], ";"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"fileIsExecutableQ", "[", 
                 RowBox[{"{", 
                  RowBox[{"pdb2xyzrExePath", ",", " ", "\"\<1\>\""}], "}"}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"RunProcess", "[", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<chmod\>\"", ",", " ", "\"\<u+x\>\"", ",", " ", 
                   "msmsExePath"}], "}"}], "]"}], ";"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "msmsExePath", ",", " ", "pdb2xyzrExePath", ",", " ", 
             "pdb2xyzrDatabasePath"}], "}"}], " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"\"\<\>\"", ",", "\"\<\>\"", ",", "\"\<\>\""}], "}"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"doReduce", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"reducePath", " ", "=", " ", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{"rootPath", ",", " ", "\"\<Reduce\>\""}], "}"}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"$OperatingSystem", "\[Equal]", "\"\<Windows\>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"reduceExePath", " ", "=", " ", 
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{"reducePath", ",", " ", "\"\<reduce.exe\>\""}], "}"}],
                "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"reduceDatabasePath", " ", "=", " ", 
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{
                "reducePath", ",", " ", "\"\<reduce_wwPDB_het_dict.txt\>\""}],
                 "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"checkFilePresentQ", "[", 
                   RowBox[{"reduceExePath", ",", " ", "verbose"}], "]"}], " ",
                   "&&", " ", 
                  RowBox[{"checkFilePresentQ", "[", 
                   RowBox[{"reduceDatabasePath", ",", " ", "verbose"}], 
                   "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"DirectoryQ", "[", "reducePath", "]"}], ",", 
                  RowBox[{"DeleteDirectory", "[", 
                   RowBox[{"reducePath", ",", 
                    RowBox[{"DeleteContents", "\[Rule]", "True"}]}], "]"}]}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"FileExistsQ", "[", "reducePath", "]"}], ",", 
                  RowBox[{"DeleteFile", "[", "reducePath", "]"}]}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"unpackedArch", " ", "=", " ", 
                 RowBox[{"loadNew", "[", 
                  RowBox[{"rootPath", ",", " ", 
                   RowBox[{"$OperatingSystem", "/.", "reduceArchiveLinks"}], 
                   ",", " ", "verbose"}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"RenameDirectory", "[", 
                 RowBox[{
                  RowBox[{"unpackedArch", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", "reducePath"}], 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"reduceExePath", " ", "=", " ", 
              RowBox[{"loadIfAbsent", "[", 
               RowBox[{"reducePath", ",", 
                RowBox[{"$OperatingSystem", "/.", "reduceArchiveLinks"}], ",",
                 " ", "verbose"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"reduceDatabasePath", " ", "=", " ", 
              RowBox[{"loadIfAbsent", "[", 
               RowBox[{
               "reducePath", ",", 
                "\"\<http://kinemage.biochem.duke.edu/downloads/software/\
reduce31/reduce_wwPDB_het_dict.txt.zip\>\"", ",", " ", "verbose"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"fileIsExecutableQ", "[", "reduceExePath", "]"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"RunProcess", "[", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<chmod\>\"", ",", " ", "\"\<u+x\>\"", ",", " ", 
                   "reduceExePath"}], "}"}], "]"}], ";"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"reduceExePath", ",", " ", "reduceDatabasePath"}], "}"}], 
           " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "msmsExePath", ",", " ", "pdb2xyzrExePath", ",", " ", 
         "pdb2xyzrDatabasePath", ",", "reduceExePath", ",", " ", 
         "reduceDatabasePath"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"checkFileThrow", "[", "filePath_", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"FileExistsQ", "[", "filePath", "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Throw", "[", 
           RowBox[{"$Failed", ",", 
            RowBox[{"fileNotFoundTag", "[", "filePath", "]"}]}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"writeAFile", "[", 
     RowBox[{"str_", ",", " ", 
      RowBox[{"filepathArg_", ":", "\"\<\>\""}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"filepath", ",", 
        RowBox[{"tmpfile", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"filepathArg", "\[Equal]", "\"\<\>\""}], ")"}]}]}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"filepath", "=", 
        RowBox[{"If", "[", 
         RowBox[{"tmpfile", ",", 
          RowBox[{"CreateFile", "[", 
           RowBox[{"OverwriteTarget", "\[Rule]", "True"}], "]"}], ",", 
          "filepathArg"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"WriteString", "[", 
        RowBox[{"filepath", ",", "str"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Close", "[", "filepath", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"tmpfile", ",", " ", "filepath", ",", " ", "Nothing"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DownloadPDB", "[", "structID_", "]"}], ":=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{
      "\"\<http://www.rcsb.org/pdb/download/downloadFile.do?fileFormat=pdb&\
compression=NO&structureId=\>\"", "<>", "structID"}], ",", "\"\<String\>\""}],
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProtonatePDB", "[", 
     RowBox[{"pdbStr_", ",", " ", 
      RowBox[{"reduceOptions_", ":", "reduceDefaultArgs"}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tempFilepath", ",", "pdbProtonated", ",", "cmd"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"checkFileThrow", "[", "reduceExePath", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tempFilepath", " ", "=", " ", 
        RowBox[{"writeAFile", "[", "pdbStr", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cmd", " ", "=", " ", 
        RowBox[{"\"\<!\>\"", "<>", "reduceExePath", "<>", "\"\< \>\"", "<>", 
         RowBox[{"TextString", "[", 
          RowBox[{"reduceOptions", ",", 
           RowBox[{"ListFormat", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<\>\"", ",", "\"\< \>\"", ",", "\"\<\>\""}], 
             "}"}]}]}], "]"}], "<>", "\"\< \>\"", "<>", "tempFilepath"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"pdbProtonated", " ", "=", " ", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"ReadList", "[", 
          RowBox[{"cmd", ",", "Character"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DeleteFile", "[", "tempFilepath", "]"}], ";", 
       "\[IndentingNewLine]", "pdbProtonated"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constructProteinSAS", "[", 
    RowBox[{
    "coords_", ",", " ", "radii_", ",", " ", "probeR_", ",", " ", "colors_"}],
     "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"colors", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
       RowBox[{"Sphere", "[", 
        RowBox[{
         RowBox[{"QuantityMagnitude", "[", 
          RowBox[{"coords", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", " ", 
         RowBox[{"QuantityMagnitude", "[", 
          RowBox[{
           RowBox[{"radii", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "+", "probeR"}], "]"}]}], "]"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", 
       RowBox[{"Length", "[", "radii", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DrawProteinSAS", "[", 
     RowBox[{"pdbStr_", ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "elements", ",", "radiiTable", ",", "presentElements", ",", 
        "colorTable", ",", " ", "radiiType", ",", " ", "probeR", ",", " ", 
        "coords"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"radiiType", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<radiiType\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"probeR", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<probeR\>\"", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"elements", " ", "=", " ", 
        RowBox[{"ImportString", "[", 
         RowBox[{"pdbStr", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<PDB\>\"", ",", 
            RowBox[{"{", "\"\<VertexTypes\>\"", "}"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"presentElements", " ", "=", " ", 
        RowBox[{"DeleteDuplicates", "[", "elements", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"colorTable", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "\[Rule]", 
             RowBox[{
              RowBox[{"ColorData", "[", "\"\<Atoms\>\"", "]"}], "[", "#", 
              "]"}]}], ")"}], "&"}], ",", " ", "presentElements"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"radiiTable", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "\[Rule]", 
             RowBox[{"UnitConvert", "[", 
              RowBox[{
               RowBox[{"ElementData", "[", 
                RowBox[{"#", ",", " ", "radiiType"}], "]"}], ",", 
               "\"\<Angstroms\>\""}], "]"}]}], ")"}], "&"}], ",", 
          "presentElements"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"coords", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Quantity", "[", 
            RowBox[{"#", ",", "\"\<Angstroms\>\""}], "]"}], "&"}], ",", 
          RowBox[{
           RowBox[{"ImportString", "[", 
            RowBox[{"pdbStr", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<PDB\>\"", ",", "\"\<VertexCoordinates\>\""}], 
              "}"}]}], "]"}], "/", "100"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "radiiType", ",", " ", "\"\<; probe radius = \>\"", ",", " ", 
         "probeR"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "radiiTable", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "colorTable", "]"}], ";", 
       RowBox[{"sas", " ", "=", " ", 
        RowBox[{"constructProteinSAS", "[", 
         RowBox[{"coords", ",", " ", 
          RowBox[{"elements", "/.", "radiiTable"}], ",", " ", "probeR", ",", 
          " ", 
          RowBox[{"elements", "/.", "colorTable"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Graphics3D", "[", "sas", "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"should", " ", "be", " ", "in", " ", 
    RowBox[{"Initialize", "[", "]"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hh", "::", "fail"}], "=", 
   "\"\<The function failed. The failure occured due to absent file `1` \
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"msmsArchiveLinks", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
     "\"\<Windows\>\"", "\[Rule]", " ", 
      "\"\<http://mgltools.scripps.edu/downloads/tars/releases/MSMSRELEASE/\
REL2.6.1/msms_win32_2.6.1.zip\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Unix\>\"", "\[Rule]", 
      "\"\<http://mgltools.scripps.edu/downloads/tars/releases/MSMSRELEASE/\
REL2.6.1/msms_i86_64Linux2_2.6.1.tar.gz\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<MacOSX\>\"", "\[Rule]", 
      "\"\<http://mgltools.scripps.edu/downloads/tars/releases/MSMSRELEASE/\
REL2.6.1/msms_MacOSX_2.6.1.tar.gz\>\""}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"msmsExeMask", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Windows\>\"", "\[Rule]", "\"\<msms.exe\>\""}], ",", 
     RowBox[{"\"\<Unix\>\"", "\[Rule]", "\"\<msms.x86_64Linux*\>\""}], ",", 
     RowBox[{"\"\<MacOSX\>\"", "\[Rule]", "\"\<msms.MacOSX.*\>\""}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reduceArchiveLinks", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
     "\"\<Windows\>\"", "\[Rule]", 
      "\"\<http://kinemage.biochem.duke.edu/downloads/software/reduce31/\
reduce.3.16.111118.winArchive.zip\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Unix\>\"", "\[Rule]", 
      "\"\<http://kinemage.biochem.duke.edu/downloads/software/reduce31/\
reduce.3.23.130521.linuxi386.gz\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<MacOSX\>\"", "\[Rule]", 
      "\"\<http://kinemage.biochem.duke.edu/downloads/software/reduce31/\
reduce.3.23.130521.macosx.zip\>\""}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "InstallMyPckg", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<rootPath\>\"", "\[Rule]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"$WolframDocumentsDirectory", ",", "\"\<PDBsys\>\""}], "}"}], 
       "]"}]}], ",", 
     RowBox[{"\"\<doMSMS\>\"", "\[Rule]", "True"}], ",", 
     RowBox[{"\"\<doReduce\>\"", "\[Rule]", "True"}], ",", 
     RowBox[{"\"\<verbose\>\"", "\[Rule]", "False"}], ",", 
     RowBox[{"\"\<forceReinstall\>\"", "\[Rule]", "False"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "msmsExePath", ",", " ", "pdb2xyzrExePath", ",", " ", 
     "pdb2xyzrDatabasePath", ",", "reduceExePath", ",", " ", 
     "reduceDatabasePath"}], "}"}], " ", "=", " ", 
   RowBox[{"InstallMyPckg", "[", 
    RowBox[{
     RowBox[{"\"\<doMSMS\>\"", "\[Rule]", "False"}], ",", " ", 
     RowBox[{"\"\<verbose\>\"", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reduceDefaultArgs", "=", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"\"\<-build\>\"", ",", "\"\<-DB\>\"", ",", 
     RowBox[{
     "\"\<\\\"\>\"", "<>", "reduceDatabasePath", "<>", "\"\<\\\"\>\""}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "DrawProteinSAS", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<probeR\>\"", "\[Rule]", 
       RowBox[{"Quantity", "[", 
        RowBox[{"1.5", ",", "\"\<Angstroms\>\""}], "]"}]}], ",", " ", 
      RowBox[{"\"\<radiiType\>\"", "\[Rule]", "\"\<VanDerWaalsRadius\>\""}]}],
      "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "\"\<AtomicRadius\>\"", ",", " ", "\"\<CovalentRadius\>\"", ",", " ", 
    "\"\<VanDerWaalsRadius\>\""}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"the", " ", "protein", " ", "to", " ", "analyse"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pdbName", " ", "=", " ", "\"\<1tf6\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pdbName", " ", "=", " ", "\"\<1aki\>\""}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "process", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Catch", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"DrawProteinSAS", "[", 
        RowBox[{"DownloadPDB", "[", "pdbName", "]"}], "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Print", "[", 
        RowBox[{"DrawProteinSAS", "[", 
         RowBox[{"ProtonatePDB", "[", 
          RowBox[{"DownloadPDB", "[", "pdbName", "]"}], "]"}], "]"}], "]"}], 
       "*)"}], ";"}], ",", "\[IndentingNewLine]", "_fileNotFoundTag", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"hh", "::", "fail"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"First", "@", "#2"}], ",", "Red"}], "]"}]}], "]"}], ";", 
        "#1"}], ")"}], "&"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.802865458098439*^9, 3.80286546064642*^9}, {
   3.802865493535953*^9, 3.802865509527236*^9}, {3.80286554009973*^9, 
   3.802865546665674*^9}, {3.802865609474028*^9, 3.802865714195086*^9}, {
   3.802866610376453*^9, 3.80286686065862*^9}, 3.802867558770838*^9, {
   3.802868131927656*^9, 3.802868199953703*^9}, {3.8028682414566307`*^9, 
   3.802868358564475*^9}, {3.802868818463656*^9, 3.802868868694529*^9}, {
   3.8028689648664837`*^9, 3.802869175659286*^9}, {3.8028692703554497`*^9, 
   3.802869316606958*^9}, {3.8028693530065928`*^9, 3.802869381303514*^9}, {
   3.8028700218150043`*^9, 3.802870110060816*^9}, {3.8028708273908463`*^9, 
   3.802870856370781*^9}, {3.802871016800839*^9, 3.8028711580799847`*^9}, {
   3.802871242572624*^9, 3.802871452886479*^9}, {3.802871503492401*^9, 
   3.8028716254723263`*^9}, {3.8028721931360683`*^9, 
   3.8028721933992558`*^9}, {3.802872255048585*^9, 3.802872267089861*^9}, {
   3.802872314104019*^9, 3.802872495614647*^9}, {3.8028725315251627`*^9, 
   3.802872547540835*^9}, {3.80287282975812*^9, 3.8028728337719927`*^9}, {
   3.802873021434867*^9, 3.802873038038164*^9}, {3.80287318399135*^9, 
   3.802873449011621*^9}, {3.80287349124014*^9, 3.802873586959833*^9}, {
   3.802873691382978*^9, 3.802873839079028*^9}, {3.80287655868112*^9, 
   3.80287662850679*^9}, {3.802876675237377*^9, 3.802876681352434*^9}, {
   3.802921264960492*^9, 3.80292132998339*^9}, {3.80292136313776*^9, 
   3.8029213631871357`*^9}, {3.802921454643304*^9, 3.802921470048642*^9}, {
   3.802930735469529*^9, 3.8029307704081583`*^9}, {3.8029309007970324`*^9, 
   3.802931016748249*^9}, 3.8029311291910143`*^9, 3.802931234528215*^9, {
   3.802931271523158*^9, 3.802931402011313*^9}, {3.802931433294941*^9, 
   3.802931482646138*^9}, {3.802931514384334*^9, 3.8029315152525387`*^9}, {
   3.802931553939829*^9, 3.80293164686627*^9}, {3.802931703217421*^9, 
   3.802931711858506*^9}, {3.8029332804764338`*^9, 3.802933375564166*^9}, {
   3.8029334316518583`*^9, 3.802933534853306*^9}, {3.802933570148375*^9, 
   3.802933571786311*^9}, {3.802933671909811*^9, 3.8029337811697607`*^9}, 
   3.802933878110136*^9, {3.80293743749225*^9, 3.802937453960333*^9}, {
   3.803189357483158*^9, 3.8031894049410477`*^9}, {3.803193626915271*^9, 
   3.803193716885849*^9}, {3.8032112648276367`*^9, 3.803211295859069*^9}, {
   3.803211403942007*^9, 3.8032114525573463`*^9}, 3.803211487596538*^9, {
   3.803211561941319*^9, 3.803211576588263*^9}, {3.80321163371446*^9, 
   3.8032116630336246`*^9}, {3.8032118599140997`*^9, 
   3.8032119010576677`*^9}, {3.8032119485283737`*^9, 
   3.8032119590400953`*^9}, {3.803212012959524*^9, 3.803212019736864*^9}, {
   3.803212146257723*^9, 3.803212157424903*^9}, {3.803212220108233*^9, 
   3.80321224675913*^9}, {3.8034719071708117`*^9, 3.803471938974265*^9}, {
   3.803471980225729*^9, 3.8034720341991053`*^9}, {3.8034722296092463`*^9, 
   3.803472301737238*^9}, 3.803472387801012*^9, {3.803472463644259*^9, 
   3.8034725102646723`*^9}, {3.803472576027404*^9, 3.803472639769761*^9}, {
   3.803472761710904*^9, 3.8034728275028067`*^9}, {3.8034729237838383`*^9, 
   3.803472927412438*^9}, {3.803473536747601*^9, 3.8034735379662113`*^9}, {
   3.8034740669594383`*^9, 3.803474087286244*^9}, {3.803474431155855*^9, 
   3.8034744574383783`*^9}, {3.803474838191493*^9, 3.803474851734948*^9}, {
   3.803475243125723*^9, 3.80347536014504*^9}, {3.803475418977263*^9, 
   3.803475484335507*^9}, {3.8034755544414577`*^9, 3.803475578772936*^9}, {
   3.8034756509043713`*^9, 3.803475777601103*^9}, {3.8034758204061213`*^9, 
   3.803475852106346*^9}, {3.803475886332591*^9, 3.803475941737364*^9}, {
   3.803475976358392*^9, 3.803475985622633*^9}, 3.803476695970896*^9, 
   3.803476744434739*^9, {3.8034769431886063`*^9, 3.803477042436466*^9}, {
   3.8034771209667473`*^9, 3.803477178149295*^9}, {3.803477226828418*^9, 
   3.803477262613262*^9}, {3.803477320642322*^9, 3.803477391483151*^9}, {
   3.803477426850778*^9, 3.8034774370964108`*^9}, {3.803477517750024*^9, 
   3.803477538482593*^9}, {3.8034776026179943`*^9, 3.803477612329108*^9}, {
   3.803477718280191*^9, 3.803477824666409*^9}, {3.803477856750381*^9, 
   3.803477943033876*^9}, {3.803477976162116*^9, 3.803478077588517*^9}, 
   3.803478131631052*^9, 3.803478176618599*^9, {3.8034787759230413`*^9, 
   3.80347886948777*^9}, {3.803478902333403*^9, 3.803479052675815*^9}, {
   3.803479098171412*^9, 3.8034791230602283`*^9}, {3.803480644628525*^9, 
   3.803480655808407*^9}, {3.8034812084742117`*^9, 3.803481391611362*^9}, {
   3.8034814251472063`*^9, 3.803481454330936*^9}, {3.803481492883708*^9, 
   3.8034815633609753`*^9}, {3.803481604480721*^9, 3.8034816210413647`*^9}, {
   3.803482100060832*^9, 3.803482210832385*^9}, {3.803482293700452*^9, 
   3.803482294430579*^9}, {3.80353093398079*^9, 3.80353093545476*^9}, 
   3.803530971603776*^9, {3.803534354784914*^9, 3.803534357040423*^9}, {
   3.8035345017464323`*^9, 3.803534534131754*^9}, {3.80353456556737*^9, 
   3.803534592487994*^9}, {3.803534627542515*^9, 3.803534628627593*^9}, {
   3.803538109021928*^9, 3.803538179690133*^9}, {3.8035382098112593`*^9, 
   3.803538211640436*^9}, {3.803538264813404*^9, 3.8035382688145638`*^9}, {
   3.803538312527787*^9, 3.803538341650052*^9}, {3.8035384025885897`*^9, 
   3.803538442453106*^9}, {3.803538509430594*^9, 3.80353855503299*^9}, {
   3.803538591707103*^9, 3.8035386825674458`*^9}, {3.8035387512233677`*^9, 
   3.803538774932425*^9}, {3.8035388128871593`*^9, 3.803538815345767*^9}, 
   3.803538874172249*^9, 3.8035390893721724`*^9, {3.803539147803238*^9, 
   3.803539211933558*^9}, 3.8035393812823467`*^9, {3.8035395837992887`*^9, 
   3.8035395887732983`*^9}, {3.8035397580653257`*^9, 3.803539801081254*^9}, {
   3.8035450845706453`*^9, 3.803545205913172*^9}, {3.803545245378586*^9, 
   3.803545247388535*^9}, {3.803545317201082*^9, 3.803545320577361*^9}, {
   3.8035453874623823`*^9, 3.803545441310215*^9}, 3.803546607469943*^9, {
   3.803546719670279*^9, 3.803546720789472*^9}, {3.803546780839913*^9, 
   3.803546795621421*^9}, {3.803546915907106*^9, 3.803546925248255*^9}, 
   3.8035469924854107`*^9, {3.803547053538848*^9, 3.803547055029031*^9}, {
   3.803555996590538*^9, 3.803556040667075*^9}, {3.803556398505762*^9, 
   3.8035564261587934`*^9}, {3.803556508296313*^9, 3.8035565356363215`*^9}, {
   3.8035565747223005`*^9, 3.8035565812763233`*^9}, {3.80355663186229*^9, 
   3.80355675537529*^9}, {3.80355679089629*^9, 3.803556799052309*^9}, {
   3.803556829713292*^9, 3.8035568469122925`*^9}, 3.803559217299797*^9, {
   3.803559250270193*^9, 3.803559277774582*^9}, {3.803559333035571*^9, 
   3.8035593591448917`*^9}, 3.8035595099790688`*^9, {3.803565326721354*^9, 
   3.803565340032318*^9}},ExpressionUUID->"5787533f-4598-4dd2-8b1f-\
1edb8c66723d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"checkFilePresentQ", "[", 
     RowBox[{"filepath_", ",", " ", 
      RowBox[{"verbose_", ":", "False"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"found", " ", "=", " ", 
        RowBox[{"FileExistsQ", "[", "filepath", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"verbose", ",", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<searching for '\>\"", ",", " ", "filepath", ",", " ", 
           "\"\<' ... \>\"", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", "found"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<NOT\>\"", ",", "Red"}], "]"}], ",", "\"\<\>\""}], 
            "]"}], ",", " ", "\"\< found\>\""}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "found"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getFilenameSafe", "[", 
     RowBox[{"path_", ",", " ", "ptrn_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"names", " ", "=", " ", 
        RowBox[{"FileNames", "[", 
         RowBox[{"ptrn", ",", "path"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "names", "]"}], ">", "0"}], ",", 
        RowBox[{"names", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"path", ",", " ", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"RandomChoice", "[", 
             RowBox[{
              RowBox[{"Alphabet", "[", "]"}], ",", "50"}], "]"}], "]"}]}], 
          "}"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getLinkFilename", "[", 
     RowBox[{"path_", ",", " ", "link_"}], "]"}], " ", ":=", " ", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"path", ",", " ", 
       RowBox[{"FileBaseName", "[", 
        RowBox[{"FileNameTake", "[", "link", "]"}], "]"}]}], "}"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"loadNew", "[", 
     RowBox[{"path_", ",", " ", "link_", ",", " ", 
      RowBox[{"verbose_", ":", "False"}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"archiveFile", ",", "unpackedFiles"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"verbose", ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<loading from '\>\"", ",", " ", "link", ",", "\"\<'\>\""}], 
           "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"archiveFile", " ", "=", " ", 
        RowBox[{"URLDownload", "[", 
         RowBox[{"link", ",", " ", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"path", ",", " ", 
             RowBox[{"FileNameTake", "[", "link", "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"CreateIntermediateDirectories", "\[Rule]", "True"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"verbose", ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"archiveFile", ",", " ", "\"\< loaded\>\""}], "]"}], 
          ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"unpackedFiles", " ", "=", " ", 
        RowBox[{"ExtractArchive", "[", 
         RowBox[{"archiveFile", ",", "path", ",", 
          RowBox[{"OverwriteTarget", "\[Rule]", "True"}], ",", 
          RowBox[{"CreateIntermediateDirectories", "\[Rule]", "True"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"verbose", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<unpacked: '\>\"", ",", " ", "unpackedFiles", ",", 
           "\"\<'\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"DeleteFile", "[", "archiveFile", "]"}], ";", 
       "\[IndentingNewLine]", "unpackedFiles"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"loadIfAbsent", "[", 
     RowBox[{"path_", ",", " ", "link_", ",", " ", 
      RowBox[{"verbose_", ":", "False"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "filepath", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"filepath", " ", "=", " ", 
        RowBox[{"getLinkFilename", "[", 
         RowBox[{"path", ",", " ", "link"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"checkFilePresentQ", "[", 
           RowBox[{"filepath", ",", " ", "verbose"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"loadNew", "[", 
           RowBox[{
            RowBox[{"DirectoryName", "[", "filepath", "]"}], ",", " ", "link",
             ",", " ", "verbose"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "filepath"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fileIsExecutableQ", "[", "cmd_", "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Quiet", "[", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"RunProcess", "[", 
         RowBox[{"cmd", ",", "\"\<ExitCode\>\""}], "]"}], ",", 
        "\"\<err\>\""}], "]"}], "]"}], "\[NotEqual]", "\"\<err\>\""}], 
    ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fileIsTheRightExecutableQ", "[", 
     RowBox[{"cmd_", ",", " ", 
      RowBox[{"testStr_", ":", "\"\<\>\""}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"localErrorFlag", "=", "\"\<err\>\""}], ",", "stdStr", ",", 
        "errStr"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"fileIsExecutableQ", "[", "cmd", "]"}], ",", 
        "\[IndentingNewLine]", "False", ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"StringStartsQ", "[", 
           RowBox[{
            RowBox[{"RunProcess", "[", 
             RowBox[{"cmd", ",", "\"\<StandardError\>\""}], "]"}], ",", " ", 
            "testStr"}], "]"}], ",", "\[IndentingNewLine]", "True", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StringStartsQ", "[", 
           RowBox[{
            RowBox[{"RunProcess", "[", 
             RowBox[{"cmd", ",", "\"\<StandardOutput\>\""}], "]"}], ",", " ", 
            "testStr"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InstallMyPckg", "[", 
     RowBox[{"OptionsPattern", "[", "]"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "reducePath", ",", "reduceExePath", ",", "reduceDatabasePath", ",", 
        " ", "reduceExeLink", ",", " ", "reduceDatabaseLink", ",", 
        "\[IndentingNewLine]", "msmsPath", ",", "msmsExePath", ",", 
        "pdb2xyzrExePath", ",", "pdb2xyzrDatabasePath", ",", "unpackedArch", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"rootPath", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "\"\<rootPath\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"doMSMS", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "\"\<doMSMS\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"doReduce", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "\"\<doReduce\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"verbose", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "\"\<verbose\>\"", "]"}]}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<forceReinstall\>\"", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"DeleteDirectory", "[", 
           RowBox[{"rootPath", ",", 
            RowBox[{"DeleteContents", "\[Rule]", "True"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"InstallMyPckg", "[", 
            RowBox[{"\"\<forceReinstall\>\"", "\[Rule]", "False"}], "]"}], 
           "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"DirectoryQ", "[", "rootPath", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"CreateDirectory", "[", 
          RowBox[{"rootPath", ",", 
           RowBox[{"CreateIntermediateDirectories", "\[Rule]", "True"}]}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"doMSMS", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"msmsPath", " ", "=", " ", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{"rootPath", ",", " ", "\"\<MSMS\>\""}], "}"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"msmsExePath", " ", "=", " ", 
           RowBox[{"getFilenameSafe", "[", 
            RowBox[{"msmsPath", ",", " ", 
             RowBox[{"$OperatingSystem", "/.", "msmsExeMask"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"pdb2xyzrExePath", " ", "=", " ", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{"msmsPath", ",", " ", "\"\<pdb_to_xyzr\>\""}], "}"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pdb2xyzrDatabasePath", " ", "=", " ", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{"msmsPath", ",", " ", "\"\<atmtypenumbers\>\""}], "}"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"checkFilePresentQ", "[", 
                RowBox[{"msmsExePath", ",", " ", "verbose"}], "]"}], "&&", 
               "\[IndentingNewLine]", 
               RowBox[{"checkFilePresentQ", "[", 
                RowBox[{"pdb2xyzrExePath", ",", " ", "verbose"}], "]"}], "&&",
                "\[IndentingNewLine]", 
               RowBox[{"checkFilePresentQ", "[", 
                RowBox[{"pdb2xyzrDatabasePath", ",", " ", "verbose"}], 
                "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"loadNew", "[", 
              RowBox[{"msmsPath", ",", " ", "\[IndentingNewLine]", 
               RowBox[{"$OperatingSystem", "/.", "msmsArchiveLinks"}], ",", 
               "verbose"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"msmsExePath", " ", "=", " ", 
           RowBox[{"getFilenameSafe", "[", 
            RowBox[{"msmsPath", ",", " ", "\"\<msms.x86_64Linux*\>\""}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"$OperatingSystem", "\[NotEqual]", "\"\<Windows\>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"fileIsExecutableQ", "[", "msmsExePath", "]"}]}], ",",
                "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"RunProcess", "[", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<chmod\>\"", ",", " ", "\"\<u+x\>\"", ",", " ", 
                   "msmsExePath"}], "}"}], "]"}], ";"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"fileIsExecutableQ", "[", 
                 RowBox[{"{", 
                  RowBox[{"pdb2xyzrExePath", ",", " ", "\"\<1\>\""}], "}"}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"RunProcess", "[", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<chmod\>\"", ",", " ", "\"\<u+x\>\"", ",", " ", 
                   "msmsExePath"}], "}"}], "]"}], ";"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "msmsExePath", ",", " ", "pdb2xyzrExePath", ",", " ", 
             "pdb2xyzrDatabasePath"}], "}"}], " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"\"\<\>\"", ",", "\"\<\>\"", ",", "\"\<\>\""}], "}"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"doReduce", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"reducePath", " ", "=", " ", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{"rootPath", ",", " ", "\"\<Reduce\>\""}], "}"}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"$OperatingSystem", "\[Equal]", "\"\<Windows\>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"reduceExePath", " ", "=", " ", 
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{"reducePath", ",", " ", "\"\<reduce.exe\>\""}], "}"}],
                "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"reduceDatabasePath", " ", "=", " ", 
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{
                "reducePath", ",", " ", "\"\<reduce_wwPDB_het_dict.txt\>\""}],
                 "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"checkFilePresentQ", "[", 
                   RowBox[{"reduceExePath", ",", " ", "verbose"}], "]"}], " ",
                   "&&", " ", 
                  RowBox[{"checkFilePresentQ", "[", 
                   RowBox[{"reduceDatabasePath", ",", " ", "verbose"}], 
                   "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"DirectoryQ", "[", "reducePath", "]"}], ",", 
                  RowBox[{"DeleteDirectory", "[", 
                   RowBox[{"reducePath", ",", 
                    RowBox[{"DeleteContents", "\[Rule]", "True"}]}], "]"}]}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"FileExistsQ", "[", "reducePath", "]"}], ",", 
                  RowBox[{"DeleteFile", "[", "reducePath", "]"}]}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"unpackedArch", " ", "=", " ", 
                 RowBox[{"loadNew", "[", 
                  RowBox[{"rootPath", ",", " ", 
                   RowBox[{"$OperatingSystem", "/.", "reduceArchiveLinks"}], 
                   ",", " ", "verbose"}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"RenameDirectory", "[", 
                 RowBox[{
                  RowBox[{"unpackedArch", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", "reducePath"}], 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"reduceExePath", " ", "=", " ", 
              RowBox[{"loadIfAbsent", "[", 
               RowBox[{"reducePath", ",", 
                RowBox[{"$OperatingSystem", "/.", "reduceArchiveLinks"}], ",",
                 " ", "verbose"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"reduceDatabasePath", " ", "=", " ", 
              RowBox[{"loadIfAbsent", "[", 
               RowBox[{
               "reducePath", ",", 
                "\"\<http://kinemage.biochem.duke.edu/downloads/software/\
reduce31/reduce_wwPDB_het_dict.txt.zip\>\"", ",", " ", "verbose"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"fileIsExecutableQ", "[", "reduceExePath", "]"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"RunProcess", "[", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<chmod\>\"", ",", " ", "\"\<u+x\>\"", ",", " ", 
                   "reduceExePath"}], "}"}], "]"}], ";"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"reduceExePath", ",", " ", "reduceDatabasePath"}], "}"}], 
           " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "msmsExePath", ",", " ", "pdb2xyzrExePath", ",", " ", 
         "pdb2xyzrDatabasePath", ",", "reduceExePath", ",", " ", 
         "reduceDatabasePath"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"should", " ", "be", " ", "in", " ", 
    RowBox[{"Initialize", "[", "]"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hh", "::", "fail"}], "=", 
   "\"\<The function failed. The failure occured due to absent file `1` \
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"msmsArchiveLinks", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
     "\"\<Windows\>\"", "\[Rule]", " ", 
      "\"\<http://mgltools.scripps.edu/downloads/tars/releases/MSMSRELEASE/\
REL2.6.1/msms_win32_2.6.1.zip\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Unix\>\"", "\[Rule]", 
      "\"\<http://mgltools.scripps.edu/downloads/tars/releases/MSMSRELEASE/\
REL2.6.1/msms_i86_64Linux2_2.6.1.tar.gz\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<MacOSX\>\"", "\[Rule]", 
      "\"\<http://mgltools.scripps.edu/downloads/tars/releases/MSMSRELEASE/\
REL2.6.1/msms_MacOSX_2.6.1.tar.gz\>\""}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"msmsExeMask", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Windows\>\"", "\[Rule]", "\"\<msms.exe\>\""}], ",", 
     RowBox[{"\"\<Unix\>\"", "\[Rule]", "\"\<msms.x86_64Linux*\>\""}], ",", 
     RowBox[{"\"\<MacOSX\>\"", "\[Rule]", "\"\<msms.MacOSX.*\>\""}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reduceArchiveLinks", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
     "\"\<Windows\>\"", "\[Rule]", 
      "\"\<http://kinemage.biochem.duke.edu/downloads/software/reduce31/\
reduce.3.16.111118.winArchive.zip\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Unix\>\"", "\[Rule]", 
      "\"\<http://kinemage.biochem.duke.edu/downloads/software/reduce31/\
reduce.3.23.130521.linuxi386.gz\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<MacOSX\>\"", "\[Rule]", 
      "\"\<http://kinemage.biochem.duke.edu/downloads/software/reduce31/\
reduce.3.23.130521.macosx.zip\>\""}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "InstallMyPckg", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<rootPath\>\"", "\[Rule]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"$WolframDocumentsDirectory", ",", "\"\<PDBsys\>\""}], "}"}], 
       "]"}]}], ",", 
     RowBox[{"\"\<doMSMS\>\"", "\[Rule]", "True"}], ",", 
     RowBox[{"\"\<doReduce\>\"", "\[Rule]", "True"}], ",", 
     RowBox[{"\"\<verbose\>\"", "\[Rule]", "False"}], ",", 
     RowBox[{"\"\<forceReinstall\>\"", "\[Rule]", "False"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "msmsExePath", ",", " ", "pdb2xyzrExePath", ",", " ", 
     "pdb2xyzrDatabasePath", ",", "reduceExePath", ",", " ", 
     "reduceDatabasePath"}], "}"}], " ", "=", " ", 
   RowBox[{"InstallMyPckg", "[", 
    RowBox[{
     RowBox[{"\"\<doMSMS\>\"", "\[Rule]", "False"}], ",", " ", 
     RowBox[{"\"\<verbose\>\"", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reduceDefaultArgs", "=", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"\"\<-build\>\"", ",", "\"\<-DB\>\"", ",", 
     RowBox[{
     "\"\<\\\"\>\"", "<>", "reduceDatabasePath", "<>", "\"\<\\\"\>\""}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "DrawProteinSAS", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<probeR\>\"", "\[Rule]", 
       RowBox[{"Quantity", "[", 
        RowBox[{"1.5", ",", "\"\<Angstroms\>\""}], "]"}]}], ",", " ", 
      RowBox[{"\"\<radiiType\>\"", "\[Rule]", "\"\<VanDerWaalsRadius\>\""}]}],
      "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "\"\<AtomicRadius\>\"", ",", " ", "\"\<CovalentRadius\>\"", ",", " ", 
    "\"\<VanDerWaalsRadius\>\""}], "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.803559515335064*^9, 3.8035595426911154`*^9}, {
   3.8035597061518216`*^9, 3.803559764278821*^9}, {3.8035598062951603`*^9, 
   3.803559818439125*^9}, {3.8035616163589945`*^9, 3.8035616219139867`*^9}, {
   3.8035617202713842`*^9, 3.803561734277383*^9}, {3.803561775317849*^9, 
   3.803561775843816*^9}, {3.80356181470888*^9, 3.803561820280814*^9}, 
   3.8035618989472675`*^9, {3.8035620040725775`*^9, 3.8035620215158772`*^9}, {
   3.8035620668399115`*^9, 3.803562134394209*^9}, {3.803562457173757*^9, 
   3.8035624628787603`*^9}, {3.803562504457432*^9, 3.8035625221884403`*^9}, {
   3.8035625832553368`*^9, 3.8035627133464656`*^9}, {3.803562757512428*^9, 
   3.803562772233464*^9}, {3.8035628327717724`*^9, 3.80356283488482*^9}, {
   3.803562878796157*^9, 3.803562905424192*^9}, {3.803563073797632*^9, 
   3.80356314865269*^9}, {3.8035632650522656`*^9, 3.803563311266122*^9}, {
   3.8035633587021894`*^9, 3.8035633647491164`*^9}, {3.803563405898117*^9, 
   3.8035634077991514`*^9}, {3.803563447412724*^9, 3.803563551298264*^9}, {
   3.8035636504563775`*^9, 3.803563696104417*^9}, {3.8035637370419645`*^9, 
   3.8035638017570906`*^9}, 3.8035639325887785`*^9, {3.8035640306418266`*^9, 
   3.803564031076825*^9}, {3.8035640787816267`*^9, 3.8035640949956717`*^9}, {
   3.8035641330246596`*^9, 3.8035641823570347`*^9}, {3.8035644157954054`*^9, 
   3.8035644279043965`*^9}, 3.803564466525363*^9, {3.803564535224922*^9, 
   3.8035645798556523`*^9}, {3.803564757531069*^9, 3.8035648097390347`*^9}, {
   3.8035648742790346`*^9, 3.8035649471910496`*^9}, {3.8035650991444883`*^9, 
   3.8035651262258883`*^9}, {3.8035651679438887`*^9, 3.803565169809854*^9}, 
   3.8035653015082693`*^9},ExpressionUUID->"e7d0488c-dcfa-473c-afb9-\
4f07541be7a3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"\"\>", ",", "\<\"\"\>", ",", "\<\"\"\>", 
   ",", "\<\"C:\\\\Users\\\\polya\\\\OneDrive\\\\Documents\\\\Wolfram\\\\\
PDBsys\\\\Reduce\\\\reduce.exe\"\>", 
   ",", "\<\"C:\\\\Users\\\\polya\\\\OneDrive\\\\Documents\\\\Wolfram\\\\\
PDBsys\\\\Reduce\\\\reduce_wwPDB_het_dict.txt\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8035647707510653`*^9, 3.8035649790930634`*^9, 3.8035650092054663`*^9, {
   3.803565155372898*^9, 3.8035651701608963`*^9}},
 CellLabel->
  "Out[490]=",ExpressionUUID->"7232f8f3-55ef-4dbd-bd08-58eaae03bd13"]
}, Open  ]]
},
WindowSize->{849., 574.8},
WindowMargins->{{Automatic, -2.3999999999998636`}, {
  Automatic, 24.599999999999998`}},
Magnification:>0.8 Inherited,
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (March 20, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"2516e1c3-8d5b-43c8-996d-5bb7e5fec405"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 38491, 864, 2683, "Input",ExpressionUUID->"5787533f-4598-4dd2-8b1f-1edb8c66723d"],
Cell[CellGroupData[{
Cell[39074, 888, 23912, 548, 1806, "Input",ExpressionUUID->"e7d0488c-dcfa-473c-afb9-4f07541be7a3"],
Cell[62989, 1438, 575, 11, 41, "Output",ExpressionUUID->"7232f8f3-55ef-4dbd-bd08-58eaae03bd13"]
}, Open  ]]
}
]
*)


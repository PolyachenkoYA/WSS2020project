(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='WolframDesktop 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       161,          7]
NotebookDataLength[     29925,        659]
NotebookOptionsPosition[     29351,        641]
NotebookOutlinePosition[     29749,        657]
CellTagsIndexPosition[     29706,        654]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Quiet", "[", 
    RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"writeAFile", "[", 
     RowBox[{"str_", ",", " ", 
      RowBox[{"filepathArg_", ":", "\"\<\>\""}]}], "]"}], ":=", "\n", "  ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"filepath", ",", 
        RowBox[{"tmpfile", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"filepathArg", "==", "\"\<\>\""}], ")"}]}]}], "}"}], ",", 
      "\n", "  ", 
      RowBox[{
       RowBox[{"filepath", "=", 
        RowBox[{"If", "[", 
         RowBox[{"tmpfile", ",", 
          RowBox[{"CreateFile", "[", 
           RowBox[{"OverwriteTarget", "->", "True"}], "]"}], ",", 
          "filepathArg"}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"WriteString", "[", 
        RowBox[{"filepath", ",", "str"}], "]"}], ";", "\n", "  ", 
       RowBox[{"Close", "[", "filepath", "]"}], ";", "\n", "  ", 
       RowBox[{"If", "[", 
        RowBox[{"tmpfile", ",", " ", "filepath", ",", " ", "Nothing"}], 
        "]"}]}]}], "\n", "  ", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"readXYZRdatabase", "[", 
    RowBox[{"filepath_", ",", " ", 
     RowBox[{"verbose_", ":", "False"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "datafile", ",", " ", "radiiData", ",", " ", "radiiTable", ",", " ", 
       "residData", ",", "i", ",", "radii"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"verbose", ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<database: \>\"", ",", " ", "filepath"}], "]"}], 
         ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"datafile", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringPart", "[", 
              RowBox[{"#", ",", "1"}], "]"}], "\[NotEqual]", "\"\<#\>\""}], 
            ",", 
            RowBox[{"StringSplit", "[", 
             RowBox[{"StringDelete", "[", 
              RowBox[{"#", ",", 
               RowBox[{"\"\<#\>\"", "~~", "___"}]}], "]"}], "]"}], ",", 
            "Nothing"}], "]"}], "&"}], ",", 
         RowBox[{"ReadList", "[", 
          RowBox[{"filepath", ",", " ", "String"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"radiiData", " ", "=", " ", 
       RowBox[{"Map", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"words", " ", "=", " ", "#"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"words", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
               "\"\<radius\>\""}], ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "words", "]"}], "\[Equal]", "5"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"words", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ";;"}], "]"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"words", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}], ",", " ", 
                  RowBox[{"words", "[", 
                   RowBox[{"[", "4", "]"}], "]"}]}], " ", "]"}]}], 
               "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
              "Nothing"}], "\[IndentingNewLine]", "]"}]}], 
           "\[IndentingNewLine]", "]"}], "&"}], "\[IndentingNewLine]", ",", 
         "datafile"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"radiiData", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Read", "[", 
           RowBox[{
            RowBox[{"StringToStream", "[", "#", "]"}], ",", "Number"}], "]"}],
           "&"}], ",", "radiiData", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"verbose", ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<radii data: \>\"", ",", "radiiData"}], "]"}], ";"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", " ", 
        RowBox[{"i", "<", 
         RowBox[{"Length", "[", "radiiData", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "this", " ", "is", " ", "the", " ", "place", " ", "to", " ", 
           "implemet"}], " ", "-", 
          RowBox[{
          "h", " ", "flag", " ", "from", " ", "the", " ", "original", " ", 
           "script"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"radii", "[", 
           RowBox[{
            RowBox[{"radiiData", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"radiiData", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"verbose", ",", " ", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<r[\>\"", ",", 
             RowBox[{
              RowBox[{"radiiData", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<] = \>\"", ",", " ", 
             RowBox[{"radii", "[", 
              RowBox[{
               RowBox[{"radiiData", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], " ", "]"}]}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"residData", " ", "=", " ", 
       RowBox[{"Map", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"words", " ", "=", " ", "#"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"words", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", 
               "\"\<radius\>\""}], ",", "\[IndentingNewLine]", "words", ",", 
              "\[IndentingNewLine]", "Nothing"}], "\[IndentingNewLine]", 
             "]"}]}], "\[IndentingNewLine]", "]"}], "&"}], 
         "\[IndentingNewLine]", ",", "datafile"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"residData", " ", "=", " ", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"residPatt", " ", "=", " ", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
              RowBox[{"atomPatt", "=", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"residPatt", "\[Equal]", "\"\<*\>\""}], ",", 
               RowBox[{"residPatt", "=", "\"\<.*\>\""}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"residPatt", " ", "=", " ", 
              RowBox[{"\"\<^\>\"", "<>", "residPatt", "<>", "\"\<$\>\""}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"atomPatt", " ", "=", " ", 
              RowBox[{"\"\<^\>\"", "<>", "atomPatt", "<>", "\"\<$\>\""}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"residPatt", ",", " ", "atomPatt", ",", " ", 
               RowBox[{"Read", "[", 
                RowBox[{
                 RowBox[{"StringToStream", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "Number"}], 
                "]"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}], "&"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "residData"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"verbose", ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<residue data: \>\"", ",", "residData"}], "]"}], 
         ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"radii", ",", " ", "residData"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "pdb2xyzr", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<rDefault\>\"", "\[Rule]", "0.01"}], ",", " ", 
     RowBox[{"\"\<verbose\>\"", "\[Rule]", "False"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pdb2xyzr", "[", 
     RowBox[{"pdb_", ",", " ", "radii_", ",", " ", "residData_", ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"nPatterns", " ", "=", " ", 
         RowBox[{"Length", "[", "residData", "]"}]}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"verbose", "=", 
         RowBox[{"OptionValue", "[", "\"\<verbose\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"rDefault", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "\"\<rDefault\>\"", "]"}]}]}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Map", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<ATOM\>\"", ",", " ", "\"\<atom\>\"", ",", " ", 
               "\"\<HETATM\>\"", ",", " ", "\"\<hetatm\>\""}], "}"}], ",", 
             " ", 
             RowBox[{
              RowBox[{"TextWords", "[", 
               RowBox[{"#", ",", "1"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"line", " ", "=", " ", "#"}], ",", "x", ",", "y", ",", 
               "z", ",", "r", ",", "resName", ",", "atomName", ",", " ", 
               "resNum", ",", "pattI", ",", " ", "beginAtomName"}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"atomName", " ", "=", " ", 
               RowBox[{"StringTake", "[", 
                RowBox[{"line", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"13", ",", "16"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"resName", " ", "=", " ", 
               RowBox[{"StringDelete", "[", 
                RowBox[{
                 RowBox[{"StringTake", "[", 
                  RowBox[{"line", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"18", ",", "20"}], "}"}]}], "]"}], ",", 
                 "\"\< \>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"resNum", " ", "=", " ", 
               RowBox[{"StringDelete", "[", 
                RowBox[{
                 RowBox[{"StringTake", "[", 
                  RowBox[{"line", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"23", ",", "26"}], "}"}]}], "]"}], ",", " ", 
                 "\"\< \>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"x", " ", "=", " ", 
               RowBox[{"Read", "[", 
                RowBox[{
                 RowBox[{"StringToStream", "[", 
                  RowBox[{"StringTake", "[", 
                   RowBox[{"line", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"31", ",", "38"}], "}"}]}], "]"}], "]"}], ",", 
                 "Number"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"y", " ", "=", " ", 
               RowBox[{"Read", "[", 
                RowBox[{
                 RowBox[{"StringToStream", "[", 
                  RowBox[{"StringTake", "[", 
                   RowBox[{"line", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"39", ",", "46"}], "}"}]}], "]"}], "]"}], ",", 
                 "Number"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"z", " ", "=", " ", 
               RowBox[{"Read", "[", 
                RowBox[{
                 RowBox[{"StringToStream", "[", 
                  RowBox[{"StringTake", "[", 
                   RowBox[{"line", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"47", ",", "54"}], "}"}]}], "]"}], "]"}], ",", 
                 "Number"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"beginAtomName", " ", "=", " ", 
               RowBox[{"StringTake", "[", 
                RowBox[{"atomName", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"StringMatchQ", "[", 
                  RowBox[{"beginAtomName", ",", 
                   RowBox[{
                   "RegularExpression", "[", "\"\<[ 0-9][HhDd]\>\"", "]"}]}], 
                  "]"}], " ", "||", " ", 
                 RowBox[{"StringMatchQ", "[", 
                  RowBox[{"beginAtomName", ",", 
                   RowBox[{
                   "RegularExpression", "[", "\"\<[Hh][^Gg]\>\"", "]"}]}], 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"atomName", " ", "=", " ", "\"\<H\>\""}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"atomName", " ", "=", " ", 
               RowBox[{"StringDelete", "[", 
                RowBox[{"atomName", ",", " ", "\"\< \>\""}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{"verbose", ",", " ", 
                RowBox[{"Print", "[", 
                 RowBox[{
                 "resNum", ",", " ", "\"\<: \>\"", ",", " ", "atomName", ",", 
                  " ", "\"\< \>\"", ",", " ", "resName", ",", "\"\< (\>\"", 
                  ",", "x", ",", " ", "\"\<;\>\"", ",", "y", ",", " ", 
                  "\"\<;\>\"", ",", "z", ",", " ", "\"\<)\>\""}], "]"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"pattI", "=", "1"}], ",", " ", 
                RowBox[{"pattI", "\[LessEqual]", "nPatterns"}], ",", 
                RowBox[{"pattI", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{"atomName", ",", " ", 
                    RowBox[{"RegularExpression", "[", 
                    RowBox[{
                    RowBox[{"residData", "[", 
                    RowBox[{"[", "pattI", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "]"}]}], " ", "]"}], 
                    "&&", "\[IndentingNewLine]", 
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{"resName", ",", " ", 
                    RowBox[{"RegularExpression", "[", 
                    RowBox[{
                    RowBox[{"residData", "[", 
                    RowBox[{"[", "pattI", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], " ", 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Break", "[", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"pattI", " ", "\[Equal]", " ", 
                 RowBox[{"nPatterns", "+", "1"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<pdb2xyzr ERROR:\\nprotein: \>\"", ",", 
                   RowBox[{"ImportString", "[", 
                    RowBox[{"pdb", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<PDB\>\"", ",", "\"\<PDBID\>\""}], "}"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", "\"\<\\nline: \>\"", 
                   ",", " ", "line", ",", "\[IndentingNewLine]", 
                   "\"\<\\nresidue number: \>\"", ",", " ", "resNum", ",", 
                   "\[IndentingNewLine]", "\"\<\\nread PATTERN: \>\"", ",", 
                   " ", "resName", ",", " ", "\"\<; \>\"", ",", " ", 
                   "atomName", ",", " ", "\"\< was NOT FOUND\>\"", ",", 
                   "\[IndentingNewLine]", "\"\<\\nusing r = \>\"", ",", " ", 
                   "rDefault"}], "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"r", " ", "=", " ", "rDefault"}], ";"}], 
                "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"r", " ", "=", " ", 
                  RowBox[{"radii", "[", 
                   RowBox[{
                    RowBox[{"residData", "[", 
                    RowBox[{"[", "pattI", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "z", ",", "r"}], "}"}]}]}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", "Nothing"}], "\[IndentingNewLine]", "]"}], 
         "&"}], "\[IndentingNewLine]", ",", 
        RowBox[{"StringSplit", "[", 
         RowBox[{"pdb", ",", "\"\<\\n\>\""}], "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"xyzrPrint", "[", "xyzr_", "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\< \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", "\"\< \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\< \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<\\n\>\""}], 
         ")"}], "&"}], ",", " ", "xyzr"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "===", "===", "===", "===", "===", "==="}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"databaseName", " ", "=", " ", "\"\<atmtypenumbers\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pdbName", " ", "=", " ", "\"\<1crn.pdb\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xyzrName", " ", "=", " ", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{
      RowBox[{"FileBaseName", "[", "pdbName", "]"}], "<>", "\"\<.xyzr\>\""}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"databasePath", " ", "=", " ", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", " ", "databaseName"}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"radii", ",", " ", "residData"}], "}"}], " ", "=", " ", 
    RowBox[{"readXYZRdatabase", "[", "databasePath", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pdb", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", " ", "pdbName"}], "}"}],
       "]"}], ",", "\"\<String\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xyzr", " ", "=", " ", 
   RowBox[{"pdb2xyzr", "[", 
    RowBox[{"pdb", ",", " ", "radii", ",", " ", "residData", ",", " ", 
     RowBox[{"\"\<verbose\>\"", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"writeAFile", "[", 
   RowBox[{
    RowBox[{"xyzrPrint", "[", "xyzr", "]"}], ",", "xyzrName"}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.803652034398033*^9, 3.803652140700144*^9}, 
   3.803652465602213*^9, {3.8036526084395742`*^9, 3.803652798860474*^9}, {
   3.803652830946212*^9, 3.8036528856250353`*^9}, {3.803652954376079*^9, 
   3.803652985206932*^9}, {3.8036530591068497`*^9, 3.803653061359878*^9}, {
   3.803871475565024*^9, 3.803871571143999*^9}, {3.8038716538283033`*^9, 
   3.803871680032205*^9}, {3.803871722081149*^9, 3.803871726833709*^9}, {
   3.803871775835943*^9, 3.803871795898964*^9}, {3.803871843480103*^9, 
   3.803871894282608*^9}, {3.803872007509364*^9, 3.8038720253076963`*^9}, {
   3.803872860649537*^9, 3.8038728833144073`*^9}, {3.803872927339965*^9, 
   3.803872936250602*^9}, {3.803872973277775*^9, 3.803873099646432*^9}, {
   3.803873138050433*^9, 3.803873138542554*^9}, {3.803873268868099*^9, 
   3.803873290493396*^9}, {3.803873409232547*^9, 3.8038734141850853`*^9}, 
   3.803873498360914*^9, {3.803873544597904*^9, 3.803873554899119*^9}, {
   3.8038736458255444`*^9, 3.803873670411787*^9}, {3.80387374061511*^9, 
   3.803873772828821*^9}, {3.803873814091373*^9, 3.803873878106617*^9}, {
   3.803874113996992*^9, 3.8038741337036543`*^9}, {3.803874208692729*^9, 
   3.803874344994459*^9}, {3.803874380408268*^9, 3.803874419719803*^9}, {
   3.803874464579503*^9, 3.8038744673512907`*^9}, {3.803874507175736*^9, 
   3.80387454171964*^9}, {3.8038747670670233`*^9, 3.803874787136915*^9}, {
   3.8038748267255363`*^9, 3.803874836819992*^9}, {3.80387487086335*^9, 
   3.803874905139936*^9}, {3.803874942328264*^9, 3.803874973713769*^9}, {
   3.803875077693211*^9, 3.803875102520443*^9}, {3.8038751931356363`*^9, 
   3.8038752000634823`*^9}, {3.803875306068697*^9, 3.803875308310651*^9}, {
   3.803875345984561*^9, 3.803875347205411*^9}, {3.803875377621442*^9, 
   3.803875443597529*^9}, {3.803875473826518*^9, 3.803875496204988*^9}, {
   3.803875536910904*^9, 3.803875550944544*^9}, {3.80387561337359*^9, 
   3.803875663272599*^9}, {3.8038757829656*^9, 3.8038757853624573`*^9}, {
   3.8038758834732113`*^9, 3.803875891360997*^9}, {3.803876339258087*^9, 
   3.803876478019209*^9}, {3.803876546957384*^9, 3.8038765921682043`*^9}, {
   3.803876708106476*^9, 3.803876727110396*^9}, {3.803876772201723*^9, 
   3.8038768399065866`*^9}, {3.8038768903572474`*^9, 
   3.8038770608498583`*^9}, {3.803877093027861*^9, 3.8038771325694933`*^9}, {
   3.803877269996043*^9, 3.8038772853643427`*^9}, {3.803877388233691*^9, 
   3.80387757767708*^9}, {3.80387772005501*^9, 3.8038777886465693`*^9}, {
   3.803877858339634*^9, 3.803877934869532*^9}, {3.803877968500392*^9, 
   3.8038780254030237`*^9}, {3.8038781418424797`*^9, 3.803878283298573*^9}, {
   3.803878781895859*^9, 3.80387886195755*^9}, {3.803878912537985*^9, 
   3.803878999605323*^9}, 3.80387903407757*^9, {3.803879096314974*^9, 
   3.803879145509837*^9}, {3.803879177616075*^9, 3.8038792372540417`*^9}, {
   3.8038793033272963`*^9, 3.803879421675006*^9}, {3.803879543576333*^9, 
   3.803879562076112*^9}, {3.803879594013475*^9, 3.803879621479107*^9}, {
   3.803879772070303*^9, 3.803879837339231*^9}, {3.803879872000394*^9, 
   3.8038799441503277`*^9}, {3.803880033085651*^9, 3.803880077779904*^9}, {
   3.803883295408461*^9, 3.8038833139350433`*^9}, {3.803883351072999*^9, 
   3.803883400655807*^9}, {3.8038834473039017`*^9, 3.803883455473466*^9}, {
   3.803883496418886*^9, 3.803883758838066*^9}, {3.8038837905086184`*^9, 
   3.803883794963661*^9}, {3.803883856221567*^9, 3.8038839744174356`*^9}, {
   3.803884026042338*^9, 3.8038841355856123`*^9}, {3.803884192051937*^9, 
   3.803884398361864*^9}, {3.803884693004429*^9, 3.803884695513897*^9}, {
   3.8038848929666243`*^9, 3.8038849644567127`*^9}, {3.8038850058487587`*^9, 
   3.803885149935165*^9}, {3.80388518649127*^9, 3.803885193411421*^9}, {
   3.803885254465222*^9, 3.803885256431754*^9}, {3.803885292349413*^9, 
   3.803885293288451*^9}, {3.8038853927985888`*^9, 3.803885447371018*^9}, {
   3.8038854871960783`*^9, 3.803885520975966*^9}, {3.80388555437354*^9, 
   3.803885584382399*^9}, {3.8038856339197283`*^9, 3.80388565809196*^9}, {
   3.803885713042445*^9, 3.803885714429097*^9}, {3.803885753397573*^9, 
   3.803885754341342*^9}, {3.8038858128524427`*^9, 3.803885812975833*^9}, {
   3.8038859507246227`*^9, 3.803885977680703*^9}, {3.803886009233335*^9, 
   3.8038860310378227`*^9}, {3.8038860931727133`*^9, 3.803886097207694*^9}, {
   3.8038861324658003`*^9, 3.803886153322042*^9}, {3.8038861949483223`*^9, 
   3.803886212074284*^9}, {3.803886346156809*^9, 3.80388634853575*^9}, {
   3.8038864734346657`*^9, 3.8038864786061687`*^9}, {3.803886565395156*^9, 
   3.8038865903022947`*^9}, {3.803886652946973*^9, 3.80388687438617*^9}, {
   3.803886910481883*^9, 3.803887028569562*^9}, {3.8038870704384212`*^9, 
   3.80388712610592*^9}, {3.803887184544557*^9, 3.8038872582036247`*^9}, {
   3.803887301773487*^9, 3.8038873069598083`*^9}, {3.803887369293532*^9, 
   3.803887374052352*^9}, {3.803887419907268*^9, 3.80388760966905*^9}, {
   3.8038876580614767`*^9, 3.803887730091241*^9}, {3.803887794553628*^9, 
   3.8038878068176928`*^9}, {3.8038878776401043`*^9, 3.803888030863558*^9}, {
   3.8038881446315107`*^9, 3.803888156586362*^9}, {3.803888203388833*^9, 
   3.803888234557234*^9}, {3.803888271816476*^9, 3.803888283770137*^9}, {
   3.803888386514564*^9, 3.803888474945532*^9}, {3.803888854058774*^9, 
   3.8038888627234907`*^9}, {3.803888965028924*^9, 3.803888977986946*^9}, {
   3.803889048129278*^9, 3.803889060557168*^9}, {3.803889169924904*^9, 
   3.8038892263526373`*^9}, {3.803889256923068*^9, 3.803889285354164*^9}, {
   3.803889323121077*^9, 3.8038893268541813`*^9}, {3.8038893974170427`*^9, 
   3.803889539002256*^9}, {3.8038895801780663`*^9, 3.80388958599061*^9}, {
   3.80388961937399*^9, 3.803889645656939*^9}, {3.8038897237981*^9, 
   3.803889731924107*^9}, {3.803889800307033*^9, 3.8038898056383142`*^9}, {
   3.803889932807529*^9, 3.8038899484837418`*^9}, {3.803890061766244*^9, 
   3.8038900731892014`*^9}, {3.803890106830021*^9, 3.803890141693369*^9}, {
   3.803890217846229*^9, 3.803890236113315*^9}, {3.803890311914517*^9, 
   3.8038903259461527`*^9}, {3.803890361003474*^9, 3.803890374079208*^9}, {
   3.803890412529056*^9, 3.8038904318506937`*^9}, {3.8038904926493673`*^9, 
   3.8038907186310263`*^9}, {3.803890748935647*^9, 3.803890770828904*^9}, {
   3.803891961264963*^9, 3.803891968359907*^9}, 
   3.803892204529978*^9},ExpressionUUID->"1fed6bb6-68b8-4382-acc0-\
4e41835977fd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InputForm", "[", 
  RowBox[{"StringDelete", "[", 
   StyleBox[
    RowBox[{"\"\< N  \>\"", ",", "\"\< \>\""}],
    ShowStringCharacters->True,
    NumberMarks->True], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.803887156845909*^9, 3.8038871785406237`*^9}, {
  3.803890287406785*^9, 3.803890299258068*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"788dd21f-6e90-4a73-a9bb-bb5579bf460a"],

Cell["\"N\"", "Output",
 CellChangeTimes->{{3.803887174845817*^9, 3.803887178915197*^9}, {
  3.803890293531238*^9, 3.803890299464581*^9}},
 CellLabel->
  "Out[112]//InputForm=",ExpressionUUID->"8d647da5-53c4-4ea5-8a9e-\
5a8b445fd77f"]
}, Open  ]]
},
WindowSize->{914.25, 692.25},
WindowMargins->{{Automatic, 3.75}, {9, Automatic}},
FrontEndVersion->"12.1 for Linux x86 (64-bit) (March 20, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"897471e2-cb43-44b7-84d8-60504b27dc89"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[561, 20, 28098, 597, 2443, "Input",ExpressionUUID->"1fed6bb6-68b8-4382-acc0-4e41835977fd"],
Cell[CellGroupData[{
Cell[28684, 621, 414, 10, 29, "Input",ExpressionUUID->"788dd21f-6e90-4a73-a9bb-bb5579bf460a"],
Cell[29101, 633, 234, 5, 48, "Output",ExpressionUUID->"8d647da5-53c4-4ea5-8a9e-5a8b445fd77f"]
}, Open  ]]
}
]
*)

